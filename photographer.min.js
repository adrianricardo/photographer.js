(function(){window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL||window.oURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;var a={flash:null,container:null,imgFormat:"png",imgWidth:null,imgHeight:null},b=function(b){this._config=d(a,b);if(!this._config.container)throw new Error("Photographer.js requires a container element");this._stream=null,this._photos=[];var c=this._config.container.clientWidth,e=this._config.container.clientHeight;this._config.imgWidth||(this._config.imgWidth=c),this._config.imgHeight||(this._config.imgHeight=e),this._video=document.createElement("video"),this._video.width=c,this._video.height=e,this._video.autoplay=!0,this._config.container.appendChild(this._video),this._canvas=document.createElement("canvas"),this._canvas.width=this._config.imgWidth,this._canvas.height=this._config.imgHeight,this._context=this._canvas.getContext("2d"),navigator.getUserMedia||(this.start=this.stop=this.takePhoto=function(){return!1})},c=b.prototype;c.start=function(){var a=this,b=function(b){a._stream=b,window.URL?a._video.src=window.URL.createObjectURL(b):a._video.src=b},c=function(a){throw new Error(a)};return navigator.getUserMedia({video:!0},b,c),!0},c.stop=function(){return this._stream&&this._stream.stop(),delete this._stream,!0},c.takePhoto=function(){this._config.flash&&this._config.flash(this._config.container),this._context.drawImage(this._video,0,0,this._config.imgWidth,this._config.imgHeight);var a=this._canvas.toDataURL("image/"+this._config.imgFormat),b=a.match(/^data:image\/(\w+);/)[1],c={src:a,format:b,width:this._config.imgWidth,height:this._config.imgHeight};return this._photos.push(d(c)),c},c.getPhotos=function(){return this._photos.slice(0)},window.Photographer=b;var d=function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c}})();